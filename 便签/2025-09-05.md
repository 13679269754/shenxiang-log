2025-09-05
### 08.5.7 InnoDB 集群和自增

Group Replication 组支持的最大节点数 : 9

 那么当集群有 7 个或更少的实例时，将 `auto_increment_increment` 设置为 7，将 `auto_increment_offset` 设置为 1 + `server_id` % 7。如果一个多主集群有 8 个或更多的实例，则将 `auto_increment_increment` 设置为实例数，将 `auto_increment_offset` 设置为 1 + `server_id` % 实例数。
 
 **多主模式**
 **要求`server_id` 是连续的**  这是innodb集群规划的建议值，只有这样才能保证`auto_increment_offset`不重复，实际可以根据自己的实际情况来处理。
 `auto_increment_increment` = 实例数
 `auto_increment_offset` = 1 + `server_id` % 实例数
 
 **单主模式**
 `auto_increment_increment` 设置为 1，将 `auto_increment_offset` 设置为 2
 
>**若使用 InnoDB Cluster（官方推荐，含 MySQL Shell 管理）**
**无需 DBA 手动控制**，集群会自动管理自增参数，包括新增节点时的调整：
>
>- **初始配置**：创建集群时，MySQL Shell 会根据节点数量自动设置 `auto_increment_increment` 和 `auto_increment_offset`（遵循之前提到的规则）。
>- **新增节点时**：
    - 当通过 `cluster.addInstance()` 添加节点后，集群会自动重新计算 `auto_increment_increment`（设为当前总节点数，或≤7 时固定为 7）。
    - 新节点的 `auto_increment_offset` 会自动通过 `1 + server_id % 总节点数` 计算，同时集群会校验新节点的 `server_id` 是否导致偏移量冲突，若冲突会提示错误并拒绝加入。
    - 所有已有节点的 `auto_increment_increment` 会自动同步更新为新的总节点数，确保步长统一。

注意验证：我没有验证                                                                

## 8.6 保护 InnoDB 集群（SSL）

memberSslMode